<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checklist Porto Mais - Recebimento de Ve√≠culo</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Arial', sans-serif; background: #f5f5f5; padding: 20px; }
        
        .container {
            max-width: 900px; margin: 0 auto; background: white; padding: 20px;
            border-radius: 8px; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        /* HEADER */
        .header { display: flex; justify-content: space-between; align-items: center; border-bottom: 3px solid #001a4d; padding-bottom: 15px; margin-bottom: 20px; }
        .logo-section { text-align: center; flex: 1; }
        .logo-text { font-size: 24px; font-weight: bold; color: #001a4d; line-height: 1.2; }
        .logo-text .mais { color: #e63946; }
        .header-subtitle { font-size: 12px; color: #666; margin-top: 5px; font-weight: bold; }

        /* INFO BAR */
        .info-header { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; margin-bottom: 20px; font-size: 12px; }
        .info-header-item { background: #f0f0f0; padding: 8px; border-left: 4px solid #001a4d; }
        .info-header-item label { display: block; font-weight: bold; color: #001a4d; margin-bottom: 3px; }
        .info-header-item input { width: 100%; padding: 5px; border: 1px solid #ddd; border-radius: 3px; font-size: 11px; }

        /* SECTIONS */
        .section { margin-bottom: 25px; page-break-inside: avoid; }
        .section-title {
            background: linear-gradient(90deg, #001a4d 0%, #003d99 100%); color: white;
            padding: 10px 15px; font-size: 14px; font-weight: bold; border-radius: 4px 4px 0 0; margin-bottom: 12px;
        }
        .section-content { border: 1px solid #ddd; border-radius: 0 0 4px 4px; padding: 15px; }

        /* FORMS */
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 12px; }
        .form-row.full { grid-template-columns: 1fr; }
        .form-row.three { grid-template-columns: 1fr 1fr 1fr; }
        .form-group { display: flex; flex-direction: column; }
        .form-group label { font-weight: bold; color: #001a4d; margin-bottom: 5px; font-size: 12px; }
        
        input[type="text"], input[type="number"], input[type="tel"], select, textarea {
            padding: 8px; border: 1px solid #bbb; border-radius: 3px; font-size: 12px; width: 100%;
            font-family: Arial, sans-serif;
        }
        textarea { resize: vertical; min-height: 60px; }

        /* CHECKBOX & RADIO */
        .checkbox-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .checkbox-item, .radio-item { display: flex; align-items: center; gap: 8px; font-size: 12px; }
        .radio-group { display: flex; gap: 15px; flex-wrap: wrap; }

        /* AVARIAS */
        .avaria-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 15px; }
        .avaria-card { border: 1px solid #ddd; padding: 10px; border-radius: 3px; background: #fafafa; }
        .avaria-card label { font-weight: bold; color: #001a4d; display: block; margin-bottom: 5px; font-size: 12px; }
        .legenda { background: #f0f0f0; padding: 10px; border-radius: 3px; font-size: 10px; margin-bottom: 15px; }

        /* ASSINATURAS */
        .signature-row { display: flex; justify-content: space-between; margin-top: 30px; gap: 20px; }
        .signature-box { flex: 1; text-align: center; }
        .signature-line { border-top: 1px solid #000; width: 80%; margin: 5px auto 0; }

        /* BUTTONS */
        .button-group { display: flex; gap: 10px; margin-bottom: 20px; justify-content: center; }
        button { padding: 12px 30px; font-size: 13px; font-weight: bold; border: none; border-radius: 4px; cursor: pointer; }
        .btn-pdf { background: #e63946; color: white; }
        .btn-clear { background: #666; color: white; }

        /* CLASSE AUXILIAR PARA O PDF (Expans√£o de texto) */
        .print-text-box {
            border: 1px solid #ccc;
            padding: 6px;
            border-radius: 3px;
            font-size: 12px;
            background: #fff;
            width: 100%;
            min-height: 25px;
            white-space: pre-wrap; /* Mant√©m quebra de linha */
            word-wrap: break-word; /* Quebra palavras longas */
            overflow: visible;
        }
    </style>
</head>
<body>
    <div class="container" id="documento">
        <!-- HEADER -->
        <div class="header">
            <div class="logo-section">
                <!-- LOGO IMAGEM -->
                <!-- Certifique-se de que o nome do arquivo da sua imagem √© 'logo.png' ou altere o src abaixo -->
                <img src="logo.png" alt="Logo Porto Mais" style="max-width: 300px; height: auto; margin-bottom: 10px;">
                
                <div class="header-subtitle">VISTORIA E RECEBIMENTO DE VE√çCULO</div>
            </div>
        </div>
        <!-- INFO HEADER -->
        <div class="info-header">
            <div class="info-header-item">
                <label>Data Entrada</label>
                <input type="date" id="data_entrada">
            </div>
            <div class="info-header-item">
                <label>Hora Entrada</label>
                <input type="time" id="hora_entrada">
            </div>
            <div class="info-header-item">
                <label>N¬∫ Sinistro/Evento</label>
                <input type="text" id="numero_evento">
            </div>
        </div>

        <!-- DADOS DA OFICINA -->
        <div class="section">
            <div class="section-title">üìç DADOS DA OFICINA CREDENCIADA</div>
            <div class="section-content">
                <div class="form-row">
                    <div class="form-group">
                        <label>Oficina Respons√°vel</label>
                        <input type="text" id="oficina_nome" placeholder="Nome da oficina">
                    </div>
                    <div class="form-group">
                        <label>Consultor T√©cnico</label>
                        <input type="text" id="consultor_nome" placeholder="Nome do consultor">
                    </div>
                </div>
            </div>
        </div>

        <!-- DADOS DO CLIENTE -->
        <div class="section">
            <div class="section-title">üë§ DADOS DO BENEFICI√ÅRIO/TERCEIRO</div>
            <div class="section-content">
                <div class="form-row full">
                    <div class="form-group">
                        <label>Tipo de Cliente</label>
                        <div class="radio-group">
                            <div class="radio-item"><input type="radio" name="tipo_cliente" value="Associado"> Associado Porto Mais</div>
                            <div class="radio-item"><input type="radio" name="tipo_cliente" value="Terceiro"> Terceiro</div>
                        </div>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Nome Completo</label>
                        <input type="text" id="cliente_nome">
                    </div>
                    <div class="form-group">
                        <label>CPF/CNPJ</label>
                        <input type="text" id="cliente_cpf">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Telefone/WhatsApp</label>
                        <input type="tel" id="cliente_telefone">
                    </div>
                    <div class="form-group">
                        <label>Ve√≠culo Trazido Por</label>
                        <select id="veiculo_trazido">
                            <option value="">-- Selecione --</option>
                            <option value="Pr√≥prio Cliente">Pr√≥prio Cliente</option>
                            <option value="Guincho">Guincho</option>
                            <option value="Outro">Outro</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>

        <!-- VEICULO -->
        <div class="section">
            <div class="section-title">üöó IDENTIFICA√á√ÉO DO VE√çCULO</div>
            <div class="section-content">
                <div class="form-row three">
                    <div class="form-group">
                        <label>Modelo/Vers√£o</label>
                        <input type="text" id="veiculo_modelo">
                    </div>
                    <div class="form-group">
                        <label>Ano/Modelo</label>
                        <input type="text" id="veiculo_ano">
                    </div>
                    <div class="form-group">
                        <label>Cor</label>
                        <input type="text" id="veiculo_cor">
                    </div>
                </div>
                <div class="form-row three">
                    <div class="form-group">
                        <label>Placa</label>
                        <input type="text" id="veiculo_placa">
                    </div>
                    <div class="form-group">
                        <label>Chassi (4 √∫ltimos)</label>
                        <input type="text" id="veiculo_chassi">
                    </div>
                    <div class="form-group">
                        <label>KM Entrada</label>
                        <input type="number" id="veiculo_km">
                    </div>
                </div>
                <div class="form-group">
                    <label>N√≠vel Combust√≠vel</label>
                    <div class="radio-group">
                        <div class="radio-item"><input type="radio" name="combustivel" value="Reserva"> Reserva</div>
                        <div class="radio-item"><input type="radio" name="combustivel" value="1/4"> 1/4</div>
                        <div class="radio-item"><input type="radio" name="combustivel" value="1/2"> 1/2</div>
                        <div class="radio-item"><input type="radio" name="combustivel" value="3/4"> 3/4</div>
                        <div class="radio-item"><input type="radio" name="combustivel" value="Cheio"> Cheio</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ITENS -->
        <div class="section">
            <div class="section-title">‚úÖ INVENT√ÅRIO DE PERTENCES</div>
            <div class="section-content">
                <div class="checkbox-grid">
                    <div class="checkbox-item"><input type="checkbox"> Chave de Roda</div>
                    <div class="checkbox-item"><input type="checkbox"> Macaco</div>
                    <div class="checkbox-item"><input type="checkbox"> Tri√¢ngulo</div>
                    <div class="checkbox-item"><input type="checkbox"> Estepe</div>
                    <div class="checkbox-item"><input type="checkbox"> Antena</div>
                    <div class="checkbox-item"><input type="checkbox"> Tapetes</div>
                    <div class="checkbox-item"><input type="checkbox"> Manual</div>
                    <div class="checkbox-item"><input type="checkbox"> Chave Reserva</div>
                    <div class="checkbox-item"><input type="checkbox"> Extintor</div>
                    <div class="checkbox-item"><input type="checkbox"> Multim√≠dia/Som</div>
                </div>
                <div class="form-group" style="margin-top: 15px;">
                    <label>Observa√ß√£o de Pertences:</label>
                    <textarea id="obs_pertences"></textarea>
                </div>
            </div>
        </div>

        <!-- PNEUS -->
        <div class="section">
            <div class="section-title">üõû SITUA√á√ÉO DOS PNEUS</div>
            <div class="section-content">
                <div class="form-row">
                    <div class="form-group">
                        <label>Dianteiros</label>
                        <div class="radio-group">
                            <div class="radio-item"><input type="radio" name="pneu_d" value="Bom"> Bom</div>
                            <div class="radio-item"><input type="radio" name="pneu_d" value="Ruim"> Ruim</div>
                            <div class="radio-item"><input type="radio" name="pneu_d" value="Irregular"> Irregular</div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Traseiros</label>
                        <div class="radio-group">
                            <div class="radio-item"><input type="radio" name="pneu_t" value="Bom"> Bom</div>
                            <div class="radio-item"><input type="radio" name="pneu_t" value="Ruim"> Ruim</div>
                            <div class="radio-item"><input type="radio" name="pneu_t" value="Irregular"> Irregular</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- AVARIAS -->
        <div class="section">
            <div class="section-title">‚ö†Ô∏è AVARIAS PR√â-EXISTENTES</div>
            <div class="section-content">
                <div class="legenda"><strong>LEGENDA:</strong> (R) Risco | (A) Amassado | (Q) Quebrado | (F) Falta | (S) Sinistro</div>
                <div class="avaria-grid">
                    <div class="avaria-card"><label>Frente/Parachoque</label><textarea></textarea></div>
                    <div class="avaria-card"><label>Lat. Esquerda</label><textarea></textarea></div>
                    <div class="avaria-card"><label>Lat. Direita</label><textarea></textarea></div>
                    <div class="avaria-card"><label>Traseira</label><textarea></textarea></div>
                    <div class="avaria-card"><label>Teto/Vidros</label><textarea></textarea></div>
                    <div class="avaria-card"><label>Painel/Luzes</label><textarea></textarea></div>
                </div>
            </div>
        </div>

        <!-- TERMO -->
        <div class="section">
            <div class="section-title">üìã AUTORIZA√á√ÉO</div>
            <div class="section-content">
                <div class="checkbox-item" style="margin-bottom: 10px;">
                    <input type="checkbox"> <strong>Autoriza√ß√£o:</strong> Autorizo a desmontagem e reparos.
                </div>
                <div class="checkbox-item">
                    <input type="checkbox"> <strong>Ci√™ncia:</strong> Ciente que danos pr√©-existentes n√£o s√£o cobertos.
                </div>
            </div>
        </div>

        <!-- ASSINATURAS -->
        <div class="section">
            <div class="section-content" style="border: none;">
                <div class="signature-row">
                    <div class="signature-box">
                        <div style="height: 40px;"></div>
                        <div class="signature-line"></div>
                        <span style="font-size: 10px; color: #666;">Respons√°vel (Oficina)</span>
                    </div>
                    <div class="signature-box">
                        <div style="height: 40px;"></div>
                        <div class="signature-line"></div>
                        <span style="font-size: 10px; color: #666;">Cliente/Entregador</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- BOT√ïES FLUTUANTES -->
    <div class="button-group">
        <button class="btn-pdf" onclick="gerarPDF()">üìÑ BAIXAR PDF (CORRIGIDO)</button>
        <button class="btn-clear" onclick="limpar()">üîÑ LIMPAR</button>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script>
        // Data autom√°tica
        document.getElementById('data_entrada').valueAsDate = new Date();

        async function gerarPDF() {
            const original = document.querySelector('.container');
            const clone = original.cloneNode(true);

            // 1. Configurar clone fora da tela para manipula√ß√£o
            clone.style.width = '800px'; // Largura fixa A4
            clone.style.position = 'absolute';
            clone.style.left = '-9999px';
            clone.style.top = '0';
            document.body.appendChild(clone);

            // 2. SUBSTITUI√á√ÉO M√ÅGICA: Troca Inputs por Texto Fixo (Evita cortes!)
            // Pegamos todos os inputs do original para copiar valores para o clone
            const inputsOriginais = original.querySelectorAll('input, textarea, select');
            const inputsClone = clone.querySelectorAll('input, textarea, select');

            inputsClone.forEach((el, index) => {
                const originalEl = inputsOriginais[index];
                const tipo = el.type;
                const tag = el.tagName.toLowerCase();

                if (tipo === 'checkbox' || tipo === 'radio') {
                    // Garante que o estado checked seja copiado visualmente
                    if (originalEl.checked) {
                        el.setAttribute('checked', 'checked');
                    } else {
                        el.removeAttribute('checked');
                    }
                } else {
                    // Cria uma div de texto para substituir o input
                    const divTexto = document.createElement('div');
                    divTexto.className = 'print-text-box'; // Usa a classe CSS que criamos
                    
                    if (tag === 'select') {
                        divTexto.innerText = originalEl.options[originalEl.selectedIndex]?.text || '';
                    } else {
                        divTexto.innerText = originalEl.value;
                    }

                    // Substitui o input pela div no clone
                    el.parentNode.replaceChild(divTexto, el);
                }
            });

            // 3. Gerar PDF a partir do clone "achatado"
            try {
                const canvas = await html2canvas(clone, {
                    scale: 2, // Alta qualidade
                    useCORS: true,
                    logging: false,
                    backgroundColor: '#ffffff'
                });

                const imgData = canvas.toDataURL('image/png');
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF('p', 'mm', 'a4');

                const imgWidth = 210; // A4 largura total
                const pageHeight = 295; // A4 altura
                const imgHeight = (canvas.height * imgWidth) / canvas.width;
                
                let heightLeft = imgHeight;
                let position = 0;

                pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                heightLeft -= pageHeight;

                while (heightLeft > 0) {
                    position = heightLeft - imgHeight;
                    pdf.addPage();
                    pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                    heightLeft -= pageHeight;
                }

                pdf.save('Checklist_PortoMais_Final.pdf');
                
            } catch (err) {
                alert('Erro: ' + err.message);
            } finally {
                // Remove o clone da mem√≥ria
                document.body.removeChild(clone);
            }
        }

        function limpar() {
            if(confirm("Limpar tudo?")) location.reload();
        }
    </script>
</body>
</html>

